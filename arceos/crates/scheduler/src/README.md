目前（项目分离之前），ArceOS已经实现了FIFO(FCFS)、CFS(Completely-Fair Share)、RR(Round Robin)三种调度算法，它们分别有不同的侧重点。

经过考虑，决定首先实现mlfq调度算法（多级队列反馈调度）。

## 项目结构调研

首先，我们的调度器应当位于`crates/scheduler`目录下的单独rust文件内，与已经实现的fifo、cfs、rr等算法并列。

`scheduler`的接口下一层将被`axtask`调用，根据不同feature选择调用不同调度器。因此在实现完成后，要通过修改`axtask`中的部分内容，将我们自己的调度器接入整个系统。

同样，在ArceOS提供的最终用户接口`libax`中，有不同调度算法的选择。这部分只要修改`Cargo.toml`，新加入`feature`并对应到`axtask`的`feature`中即可。

## 实现方式分析

ArceOS为调度器提供了一个统一的接口(trait)`BaseScheduler`，调用时只使用该trait，因此我们的调度器只需要完成`BaseScheduler`内的方法。由于官方已经实现了同样用到队列的rr调度算法，部分与系统相关的细节可以参考该算法的处理方式。

**注意：ArceOS支持多处理器，因此原则上要考虑memory consistence的问题。但这个问题较为复杂，因此可能视情况先选择只考虑单处理器/全部采用最强的seq时序。**

## 算法本身分析

mlfq本身是一个十分复杂的调度算法。参考课本，我们需要确定以下参数（其中部分参数可以像RR时间片那样，作为调用时给定的参数；但部分参数显然是由实现确定，无法方便地修改的）：
- 队列数量/优先级数量（调用时给定）；
- 每个队列的调度算法（选用RR应该足够）；
- 用以确定何时升级到更高优先级队列的方法；
- 用以确定何时降级到更低优先级队列的方法；
- 用以确定进程在需要服务时将会进入哪个队列的方法。

对于后三点，有大量不同的方式，要综合需求、性能、实现难度等方面考虑。